/venv/mil/lib/python3.11/site-packages/torchmetrics/utilities/imports.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import DistributionNotFound, get_distribution
Used config: {'B': 16, 'use_contrastive_loss': False, 'temperature': 0.3, 'alpha': 0.5, 'train_epoch': 30, 'warmup_epoch': 1, 'wd': 5e-05, 'lr': 0.001, 'min_lr': 0, 'dataset': 'CAMELYON17', 'n_class': 4, 'data_dir': './Feature/camelyon17Feature/patch_feats_pretrain_medical_ssl.h5', 'n_worker': 8, 'pin_memory': False, 'n_shot': -1, 'backbone': 'ViT-S/16', 'pretrain': 'medical_ssl', 'D_feat': 384, 'D_inner': 128, 'config': 'config_auto/c_17_16a.yml'}
Configuration:
<utils.Struct object at 0x72952b104750>
* Acc@1 23.333 loss 1.332 auroc 0.478 f1_score 0.139
* Acc@1 34.500 loss 1.282 auroc 0.623 f1_score 0.189
------------------------------
* Acc@1 50.000 loss 1.225 auroc 0.682 f1_score 0.167
* Acc@1 60.500 loss 1.038 auroc 0.622 f1_score 0.188
------------------------------
* Acc@1 50.000 loss 1.123 auroc 0.662 f1_score 0.167
* Acc@1 66.500 loss 0.950 auroc 0.676 f1_score 0.301
------------------------------
* Acc@1 70.000 loss 0.815 auroc 0.802 f1_score 0.407
* Acc@1 81.000 loss 0.640 auroc 0.815 f1_score 0.447
------------------------------
* Acc@1 80.000 loss 0.526 auroc 0.936 f1_score 0.552
* Acc@1 81.000 loss 0.533 auroc 0.879 f1_score 0.436
------------------------------
* Acc@1 86.667 loss 0.552 auroc 0.897 f1_score 0.623
* Acc@1 81.000 loss 0.552 auroc 0.850 f1_score 0.434
------------------------------
* Acc@1 70.000 loss 0.600 auroc 0.921 f1_score 0.459
* Acc@1 82.000 loss 0.509 auroc 0.888 f1_score 0.561
------------------------------
* Acc@1 76.667 loss 0.565 auroc 0.886 f1_score 0.515
* Acc@1 81.000 loss 0.487 auroc 0.876 f1_score 0.475
------------------------------
* Acc@1 76.667 loss 0.689 auroc 0.876 f1_score 0.515
* Acc@1 84.000 loss 0.477 auroc 0.882 f1_score 0.542
------------------------------
* Acc@1 76.667 loss 0.719 auroc 0.881 f1_score 0.515
* Acc@1 84.500 loss 0.496 auroc 0.877 f1_score 0.596
------------------------------
* Acc@1 80.000 loss 0.707 auroc 0.867 f1_score 0.544
* Acc@1 82.000 loss 0.517 auroc 0.865 f1_score 0.499
------------------------------
* Acc@1 76.667 loss 0.730 auroc 0.831 f1_score 0.515
* Acc@1 82.000 loss 0.522 auroc 0.879 f1_score 0.512
------------------------------
* Acc@1 76.667 loss 0.712 auroc 0.875 f1_score 0.515
* Acc@1 81.000 loss 0.549 auroc 0.866 f1_score 0.489
------------------------------
* Acc@1 76.667 loss 0.731 auroc 0.844 f1_score 0.515
* Acc@1 82.000 loss 0.543 auroc 0.874 f1_score 0.539
------------------------------
* Acc@1 76.667 loss 0.741 auroc 0.827 f1_score 0.515
* Acc@1 81.500 loss 0.547 auroc 0.870 f1_score 0.517
------------------------------
* Acc@1 80.000 loss 0.715 auroc 0.842 f1_score 0.544
* Acc@1 81.000 loss 0.584 auroc 0.857 f1_score 0.490
------------------------------
* Acc@1 76.667 loss 0.798 auroc 0.813 f1_score 0.515
* Acc@1 82.500 loss 0.554 auroc 0.860 f1_score 0.536
------------------------------
* Acc@1 80.000 loss 0.820 auroc 0.829 f1_score 0.544
* Acc@1 81.000 loss 0.579 auroc 0.857 f1_score 0.489
------------------------------
* Acc@1 76.667 loss 0.837 auroc 0.796 f1_score 0.515
* Acc@1 82.500 loss 0.576 auroc 0.854 f1_score 0.536
------------------------------
* Acc@1 80.000 loss 0.824 auroc 0.820 f1_score 0.544
* Acc@1 80.500 loss 0.579 auroc 0.860 f1_score 0.499
------------------------------
* Acc@1 80.000 loss 0.897 auroc 0.788 f1_score 0.544
* Acc@1 82.500 loss 0.577 auroc 0.857 f1_score 0.553
------------------------------
* Acc@1 80.000 loss 0.877 auroc 0.810 f1_score 0.544
* Acc@1 81.000 loss 0.589 auroc 0.854 f1_score 0.487
------------------------------
* Acc@1 80.000 loss 0.881 auroc 0.803 f1_score 0.544
* Acc@1 82.000 loss 0.579 auroc 0.858 f1_score 0.521
------------------------------
* Acc@1 80.000 loss 0.889 auroc 0.799 f1_score 0.544
* Acc@1 82.000 loss 0.585 auroc 0.855 f1_score 0.521
------------------------------
* Acc@1 80.000 loss 0.890 auroc 0.802 f1_score 0.544
* Acc@1 82.000 loss 0.588 auroc 0.854 f1_score 0.521
------------------------------
* Acc@1 80.000 loss 0.908 auroc 0.790 f1_score 0.544
* Acc@1 82.000 loss 0.592 auroc 0.852 f1_score 0.521
------------------------------
* Acc@1 80.000 loss 0.893 auroc 0.800 f1_score 0.544
* Acc@1 82.000 loss 0.594 auroc 0.850 f1_score 0.521
------------------------------
* Acc@1 80.000 loss 0.896 auroc 0.800 f1_score 0.544
* Acc@1 82.000 loss 0.595 auroc 0.851 f1_score 0.521
------------------------------
* Acc@1 80.000 loss 0.898 auroc 0.800 f1_score 0.544
* Acc@1 82.000 loss 0.596 auroc 0.851 f1_score 0.521
------------------------------
* Acc@1 80.000 loss 0.899 auroc 0.800 f1_score 0.544
* Acc@1 82.000 loss 0.596 auroc 0.851 f1_score 0.521
------------------------------
Results on best epoch:
{'epoch': 5, 'val_acc': 86.66666768391927, 'val_auc': 0.8970669507980347, 'val_f1': 0.6232638955116272, 'test_acc': 81.0, 'test_auc': 0.8501309752464294, 'test_f1': 0.43395721912384033}
