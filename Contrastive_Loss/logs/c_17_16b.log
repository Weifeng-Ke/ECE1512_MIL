/venv/mil/lib/python3.11/site-packages/torchmetrics/utilities/imports.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import DistributionNotFound, get_distribution
Used config: {'B': 16, 'use_contrastive_loss': True, 'temperature': 0.3, 'alpha': 0.5, 'train_epoch': 30, 'warmup_epoch': 1, 'wd': 5e-05, 'lr': 0.001, 'min_lr': 0, 'dataset': 'CAMELYON17', 'n_class': 4, 'data_dir': './Feature/camelyon17Feature/patch_feats_pretrain_medical_ssl.h5', 'n_worker': 8, 'pin_memory': False, 'n_shot': -1, 'backbone': 'ViT-S/16', 'pretrain': 'medical_ssl', 'D_feat': 384, 'D_inner': 128, 'config': 'config_auto/c_17_16b.yml'}
Configuration:
<utils.Struct object at 0x7d2557b071d0>
* Acc@1 23.333 loss 1.787 auroc 0.480 f1_score 0.139
* Acc@1 34.000 loss 1.852 auroc 0.623 f1_score 0.187
------------------------------
* Acc@1 50.000 loss 1.449 auroc 0.604 f1_score 0.167
* Acc@1 60.500 loss 1.699 auroc 0.558 f1_score 0.188
------------------------------
* Acc@1 50.000 loss 1.298 auroc 0.661 f1_score 0.167
* Acc@1 64.000 loss 1.627 auroc 0.626 f1_score 0.260
------------------------------
* Acc@1 63.333 loss 1.196 auroc 0.679 f1_score 0.350
* Acc@1 78.000 loss 1.515 auroc 0.736 f1_score 0.426
------------------------------
* Acc@1 73.333 loss 1.075 auroc 0.869 f1_score 0.431
* Acc@1 82.000 loss 1.477 auroc 0.746 f1_score 0.450
------------------------------
* Acc@1 73.333 loss 1.031 auroc 0.775 f1_score 0.431
* Acc@1 82.000 loss 1.435 auroc 0.788 f1_score 0.448
------------------------------
* Acc@1 73.333 loss 0.974 auroc 0.870 f1_score 0.431
* Acc@1 82.500 loss 1.410 auroc 0.819 f1_score 0.451
------------------------------
* Acc@1 73.333 loss 0.944 auroc 0.846 f1_score 0.421
* Acc@1 82.000 loss 1.398 auroc 0.847 f1_score 0.469
------------------------------
* Acc@1 73.333 loss 0.959 auroc 0.846 f1_score 0.421
* Acc@1 82.500 loss 1.362 auroc 0.854 f1_score 0.492
------------------------------
* Acc@1 70.000 loss 0.953 auroc 0.790 f1_score 0.403
* Acc@1 83.000 loss 1.364 auroc 0.850 f1_score 0.510
------------------------------
* Acc@1 73.333 loss 0.919 auroc 0.891 f1_score 0.421
* Acc@1 82.500 loss 1.357 auroc 0.834 f1_score 0.467
------------------------------
* Acc@1 73.333 loss 0.862 auroc 0.887 f1_score 0.420
* Acc@1 82.500 loss 1.373 auroc 0.828 f1_score 0.465
------------------------------
* Acc@1 70.000 loss 0.866 auroc 0.872 f1_score 0.402
* Acc@1 83.000 loss 1.355 auroc 0.837 f1_score 0.508
------------------------------
* Acc@1 73.333 loss 0.881 auroc 0.882 f1_score 0.470
* Acc@1 82.000 loss 1.350 auroc 0.833 f1_score 0.462
------------------------------
* Acc@1 73.333 loss 0.859 auroc 0.849 f1_score 0.470
* Acc@1 82.500 loss 1.368 auroc 0.822 f1_score 0.485
------------------------------
* Acc@1 70.000 loss 0.868 auroc 0.857 f1_score 0.402
* Acc@1 82.000 loss 1.358 auroc 0.825 f1_score 0.461
------------------------------
* Acc@1 76.667 loss 0.843 auroc 0.887 f1_score 0.515
* Acc@1 82.000 loss 1.364 auroc 0.826 f1_score 0.480
------------------------------
* Acc@1 70.000 loss 0.924 auroc 0.805 f1_score 0.402
* Acc@1 82.500 loss 1.358 auroc 0.819 f1_score 0.465
------------------------------
* Acc@1 73.333 loss 0.866 auroc 0.860 f1_score 0.464
* Acc@1 81.500 loss 1.361 auroc 0.823 f1_score 0.477
------------------------------
* Acc@1 73.333 loss 0.865 auroc 0.865 f1_score 0.471
* Acc@1 81.500 loss 1.361 auroc 0.824 f1_score 0.477
------------------------------
* Acc@1 73.333 loss 0.895 auroc 0.848 f1_score 0.471
* Acc@1 81.000 loss 1.363 auroc 0.821 f1_score 0.483
------------------------------
* Acc@1 73.333 loss 0.877 auroc 0.860 f1_score 0.471
* Acc@1 80.500 loss 1.380 auroc 0.813 f1_score 0.458
------------------------------
* Acc@1 73.333 loss 0.886 auroc 0.855 f1_score 0.471
* Acc@1 83.500 loss 1.360 auroc 0.824 f1_score 0.563
------------------------------
* Acc@1 73.333 loss 0.896 auroc 0.835 f1_score 0.471
* Acc@1 80.500 loss 1.371 auroc 0.819 f1_score 0.481
------------------------------
* Acc@1 73.333 loss 0.906 auroc 0.820 f1_score 0.471
* Acc@1 80.500 loss 1.370 auroc 0.820 f1_score 0.481
------------------------------
* Acc@1 73.333 loss 0.918 auroc 0.822 f1_score 0.471
* Acc@1 80.500 loss 1.367 auroc 0.821 f1_score 0.481
------------------------------
* Acc@1 73.333 loss 0.915 auroc 0.821 f1_score 0.471
* Acc@1 81.000 loss 1.367 auroc 0.822 f1_score 0.503
------------------------------
* Acc@1 73.333 loss 0.913 auroc 0.823 f1_score 0.471
* Acc@1 81.000 loss 1.369 auroc 0.822 f1_score 0.503
------------------------------
* Acc@1 73.333 loss 0.914 auroc 0.821 f1_score 0.471
* Acc@1 81.000 loss 1.369 auroc 0.821 f1_score 0.503
------------------------------
* Acc@1 73.333 loss 0.914 auroc 0.823 f1_score 0.471
* Acc@1 81.000 loss 1.368 auroc 0.821 f1_score 0.503
------------------------------
Results on best epoch:
{'epoch': 16, 'val_acc': 76.66666768391927, 'val_auc': 0.8869753479957581, 'val_f1': 0.5147727131843567, 'test_acc': 82.0, 'test_auc': 0.8259197473526001, 'test_f1': 0.4801071882247925}
