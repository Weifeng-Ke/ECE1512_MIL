/venv/mil/lib/python3.11/site-packages/torchmetrics/utilities/imports.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import DistributionNotFound, get_distribution
Used config: {'train_epoch': 50, 'warmup_epoch': 0, 'wd': 5e-05, 'lr': 0.05, 'min_lr': 0, 'dataset': 'BRACS', 'n_class': 3, 'data_dir': './Feature/BRACSFeature/patch_feats_pretrain_medical_ssl.h5', 'n_worker': 8, 'pin_memory': False, 'n_shot': -1, 'B': 16, 'use_contrastive_loss': True, 'temperature': 0.1, 'alpha': 0.7, 'backbone': 'ViT-S/16', 'pretrain': 'medical_ssl', 'D_feat': 384, 'D_inner': 128, 'config': 'config_auto/b_16f.yml'}
Configuration:
<utils.Struct object at 0x70e961728750>
* Acc@1 64.516 loss 1.076 auroc 0.715 f1_score 0.474
* Acc@1 59.302 loss 0.967 auroc 0.712 f1_score 0.484
------------------------------
* Acc@1 66.129 loss 1.013 auroc 0.734 f1_score 0.491
* Acc@1 53.488 loss 0.864 auroc 0.730 f1_score 0.413
------------------------------
* Acc@1 67.742 loss 0.987 auroc 0.758 f1_score 0.504
* Acc@1 56.977 loss 0.829 auroc 0.736 f1_score 0.441
------------------------------
* Acc@1 62.903 loss 0.962 auroc 0.763 f1_score 0.463
* Acc@1 54.651 loss 0.809 auroc 0.718 f1_score 0.429
------------------------------
* Acc@1 67.742 loss 0.921 auroc 0.798 f1_score 0.505
* Acc@1 58.140 loss 0.758 auroc 0.742 f1_score 0.451
------------------------------
* Acc@1 72.581 loss 0.901 auroc 0.815 f1_score 0.541
* Acc@1 59.302 loss 0.736 auroc 0.762 f1_score 0.459
------------------------------
* Acc@1 69.355 loss 0.884 auroc 0.816 f1_score 0.519
* Acc@1 58.140 loss 0.724 auroc 0.758 f1_score 0.451
------------------------------
* Acc@1 69.355 loss 0.868 auroc 0.816 f1_score 0.517
* Acc@1 55.814 loss 0.713 auroc 0.752 f1_score 0.432
------------------------------
* Acc@1 69.355 loss 0.884 auroc 0.810 f1_score 0.517
* Acc@1 55.814 loss 0.712 auroc 0.741 f1_score 0.433
------------------------------
* Acc@1 69.355 loss 0.891 auroc 0.817 f1_score 0.517
* Acc@1 56.977 loss 0.699 auroc 0.770 f1_score 0.441
------------------------------
* Acc@1 70.968 loss 0.858 auroc 0.823 f1_score 0.530
* Acc@1 55.814 loss 0.691 auroc 0.763 f1_score 0.431
------------------------------
* Acc@1 67.742 loss 0.854 auroc 0.821 f1_score 0.507
* Acc@1 59.302 loss 0.702 auroc 0.749 f1_score 0.470
------------------------------
* Acc@1 69.355 loss 0.846 auroc 0.828 f1_score 0.519
* Acc@1 55.814 loss 0.691 auroc 0.754 f1_score 0.433
------------------------------
* Acc@1 70.968 loss 0.883 auroc 0.836 f1_score 0.528
* Acc@1 59.302 loss 0.687 auroc 0.776 f1_score 0.457
------------------------------
* Acc@1 70.968 loss 0.851 auroc 0.833 f1_score 0.529
* Acc@1 59.302 loss 0.671 auroc 0.770 f1_score 0.459
------------------------------
* Acc@1 69.355 loss 0.836 auroc 0.831 f1_score 0.519
* Acc@1 56.977 loss 0.688 auroc 0.750 f1_score 0.441
------------------------------
* Acc@1 70.968 loss 0.844 auroc 0.844 f1_score 0.529
* Acc@1 56.977 loss 0.665 auroc 0.766 f1_score 0.441
------------------------------
* Acc@1 70.968 loss 0.851 auroc 0.830 f1_score 0.530
* Acc@1 56.977 loss 0.666 auroc 0.749 f1_score 0.441
------------------------------
* Acc@1 67.742 loss 0.821 auroc 0.840 f1_score 0.507
* Acc@1 54.651 loss 0.678 auroc 0.741 f1_score 0.424
------------------------------
* Acc@1 69.355 loss 0.853 auroc 0.831 f1_score 0.515
* Acc@1 58.140 loss 0.686 auroc 0.747 f1_score 0.456
------------------------------
* Acc@1 70.968 loss 0.846 auroc 0.837 f1_score 0.530
* Acc@1 58.140 loss 0.676 auroc 0.758 f1_score 0.449
------------------------------
* Acc@1 69.355 loss 0.849 auroc 0.837 f1_score 0.519
* Acc@1 56.977 loss 0.679 auroc 0.758 f1_score 0.441
------------------------------
* Acc@1 70.968 loss 0.877 auroc 0.834 f1_score 0.530
* Acc@1 58.140 loss 0.696 auroc 0.754 f1_score 0.450
------------------------------
* Acc@1 70.968 loss 0.876 auroc 0.818 f1_score 0.529
* Acc@1 59.302 loss 0.684 auroc 0.769 f1_score 0.481
------------------------------
* Acc@1 69.355 loss 0.885 auroc 0.825 f1_score 0.522
* Acc@1 59.302 loss 0.681 auroc 0.774 f1_score 0.457
------------------------------
* Acc@1 67.742 loss 0.868 auroc 0.823 f1_score 0.507
* Acc@1 55.814 loss 0.684 auroc 0.751 f1_score 0.434
------------------------------
* Acc@1 69.355 loss 0.862 auroc 0.824 f1_score 0.519
* Acc@1 59.302 loss 0.685 auroc 0.756 f1_score 0.462
------------------------------
* Acc@1 67.742 loss 0.881 auroc 0.825 f1_score 0.506
* Acc@1 56.977 loss 0.699 auroc 0.758 f1_score 0.441
------------------------------
* Acc@1 67.742 loss 0.888 auroc 0.822 f1_score 0.510
* Acc@1 59.302 loss 0.679 auroc 0.772 f1_score 0.457
------------------------------
* Acc@1 67.742 loss 0.862 auroc 0.825 f1_score 0.507
* Acc@1 56.977 loss 0.684 auroc 0.749 f1_score 0.442
------------------------------
* Acc@1 70.968 loss 0.877 auroc 0.830 f1_score 0.529
* Acc@1 60.465 loss 0.691 auroc 0.764 f1_score 0.472
------------------------------
* Acc@1 67.742 loss 0.879 auroc 0.824 f1_score 0.506
* Acc@1 59.302 loss 0.690 auroc 0.764 f1_score 0.459
------------------------------
* Acc@1 70.968 loss 0.884 auroc 0.824 f1_score 0.529
* Acc@1 59.302 loss 0.688 auroc 0.764 f1_score 0.463
------------------------------
* Acc@1 70.968 loss 0.871 auroc 0.832 f1_score 0.529
* Acc@1 56.977 loss 0.693 auroc 0.761 f1_score 0.447
------------------------------
* Acc@1 69.355 loss 0.888 auroc 0.826 f1_score 0.517
* Acc@1 56.977 loss 0.701 auroc 0.756 f1_score 0.444
------------------------------
* Acc@1 70.968 loss 0.886 auroc 0.827 f1_score 0.529
* Acc@1 56.977 loss 0.698 auroc 0.752 f1_score 0.447
------------------------------
* Acc@1 69.355 loss 0.886 auroc 0.825 f1_score 0.517
* Acc@1 55.814 loss 0.697 auroc 0.757 f1_score 0.435
------------------------------
* Acc@1 70.968 loss 0.887 auroc 0.820 f1_score 0.529
* Acc@1 56.977 loss 0.698 auroc 0.758 f1_score 0.447
------------------------------
* Acc@1 69.355 loss 0.888 auroc 0.817 f1_score 0.517
* Acc@1 55.814 loss 0.699 auroc 0.762 f1_score 0.438
------------------------------
* Acc@1 69.355 loss 0.888 auroc 0.819 f1_score 0.517
* Acc@1 54.651 loss 0.709 auroc 0.750 f1_score 0.429
------------------------------
* Acc@1 69.355 loss 0.887 auroc 0.823 f1_score 0.517
* Acc@1 55.814 loss 0.701 auroc 0.754 f1_score 0.438
------------------------------
* Acc@1 70.968 loss 0.896 auroc 0.822 f1_score 0.529
* Acc@1 58.140 loss 0.701 auroc 0.755 f1_score 0.456
------------------------------
* Acc@1 70.968 loss 0.891 auroc 0.823 f1_score 0.529
* Acc@1 56.977 loss 0.704 auroc 0.752 f1_score 0.447
------------------------------
* Acc@1 69.355 loss 0.886 auroc 0.824 f1_score 0.517
* Acc@1 54.651 loss 0.698 auroc 0.754 f1_score 0.429
------------------------------
* Acc@1 70.968 loss 0.889 auroc 0.823 f1_score 0.529
* Acc@1 54.651 loss 0.701 auroc 0.753 f1_score 0.429
------------------------------
* Acc@1 69.355 loss 0.890 auroc 0.822 f1_score 0.517
* Acc@1 55.814 loss 0.700 auroc 0.756 f1_score 0.438
------------------------------
* Acc@1 69.355 loss 0.892 auroc 0.821 f1_score 0.517
* Acc@1 56.977 loss 0.701 auroc 0.756 f1_score 0.447
------------------------------
* Acc@1 69.355 loss 0.893 auroc 0.822 f1_score 0.517
* Acc@1 58.140 loss 0.700 auroc 0.756 f1_score 0.456
------------------------------
* Acc@1 69.355 loss 0.892 auroc 0.822 f1_score 0.517
* Acc@1 58.140 loss 0.701 auroc 0.756 f1_score 0.456
------------------------------
* Acc@1 69.355 loss 0.892 auroc 0.822 f1_score 0.517
* Acc@1 58.140 loss 0.701 auroc 0.755 f1_score 0.456
------------------------------
Results on best epoch:
{'epoch': 16, 'val_acc': 70.96774291992188, 'val_auc': 0.8437067270278931, 'val_f1': 0.5287749767303467, 'test_acc': 56.97674418604651, 'test_auc': 0.7663633823394775, 'test_f1': 0.4406268894672394}
