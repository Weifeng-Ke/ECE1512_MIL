/venv/mil/lib/python3.11/site-packages/torchmetrics/utilities/imports.py:23: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import DistributionNotFound, get_distribution
Used config: {'train_epoch': 25, 'warmup_epoch': 1, 'wd': 5e-05, 'lr': 0.001, 'min_lr': 0, 'dataset': 'CAMELYON16', 'n_class': 2, 'data_dir': './Feature/camelyon16Feature/patch_feats_pretrain_medical_ssl.h5', 'n_worker': 16, 'pin_memory': False, 'n_shot': -1, 'n_token': 2, 'B': 16, 'use_contrastive_loss': True, 'temperature': 0.3, 'alpha': 0.7, 'backbone': 'ViT-S/16', 'pretrain': 'medical_ssl', 'D_feat': 384, 'D_inner': 128, 'config': 'config_auto/c_16_16c.yml'}
Configuration:
<utils.Struct object at 0x7648b605fa10>
* Acc@1 48.148 loss 1.225 auroc 0.588 f1_score 0.325
* Acc@1 62.016 loss 0.383 auroc 0.729 f1_score 0.383
------------------------------
* Acc@1 51.852 loss 1.031 auroc 0.720 f1_score 0.400
* Acc@1 64.341 loss 0.314 auroc 0.538 f1_score 0.446
------------------------------
* Acc@1 81.481 loss 0.851 auroc 0.901 f1_score 0.811
* Acc@1 72.868 loss 0.203 auroc 0.770 f1_score 0.654
------------------------------
* Acc@1 81.481 loss 0.805 auroc 0.901 f1_score 0.811
* Acc@1 82.946 loss 0.136 auroc 0.830 f1_score 0.801
------------------------------
* Acc@1 96.296 loss 0.668 auroc 0.995 f1_score 0.963
* Acc@1 87.597 loss 0.071 auroc 0.931 f1_score 0.867
------------------------------
* Acc@1 96.296 loss 0.639 auroc 0.995 f1_score 0.963
* Acc@1 90.698 loss 0.049 auroc 0.921 f1_score 0.900
------------------------------
* Acc@1 96.296 loss 0.586 auroc 1.000 f1_score 0.963
* Acc@1 93.798 loss -0.018 auroc 0.956 f1_score 0.934
------------------------------
* Acc@1 96.296 loss 0.583 auroc 1.000 f1_score 0.963
* Acc@1 95.349 loss -0.037 auroc 0.957 f1_score 0.949
------------------------------
* Acc@1 96.296 loss 0.583 auroc 1.000 f1_score 0.963
* Acc@1 95.349 loss -0.035 auroc 0.951 f1_score 0.949
------------------------------
* Acc@1 96.296 loss 0.568 auroc 1.000 f1_score 0.963
* Acc@1 95.349 loss -0.042 auroc 0.955 f1_score 0.950
------------------------------
* Acc@1 96.296 loss 0.553 auroc 1.000 f1_score 0.963
* Acc@1 96.124 loss -0.059 auroc 0.962 f1_score 0.958
------------------------------
* Acc@1 96.296 loss 0.552 auroc 1.000 f1_score 0.963
* Acc@1 94.574 loss -0.058 auroc 0.962 f1_score 0.941
------------------------------
* Acc@1 96.296 loss 0.549 auroc 1.000 f1_score 0.963
* Acc@1 95.349 loss -0.050 auroc 0.964 f1_score 0.950
------------------------------
* Acc@1 96.296 loss 0.544 auroc 1.000 f1_score 0.963
* Acc@1 96.124 loss -0.062 auroc 0.963 f1_score 0.958
------------------------------
* Acc@1 96.296 loss 0.546 auroc 1.000 f1_score 0.963
* Acc@1 96.124 loss -0.062 auroc 0.961 f1_score 0.958
------------------------------
* Acc@1 96.296 loss 0.535 auroc 1.000 f1_score 0.963
* Acc@1 96.124 loss -0.070 auroc 0.970 f1_score 0.958
------------------------------
* Acc@1 96.296 loss 0.535 auroc 1.000 f1_score 0.963
* Acc@1 96.124 loss -0.072 auroc 0.969 f1_score 0.958
------------------------------
* Acc@1 96.296 loss 0.535 auroc 1.000 f1_score 0.963
* Acc@1 95.349 loss -0.072 auroc 0.969 f1_score 0.950
------------------------------
* Acc@1 96.296 loss 0.535 auroc 1.000 f1_score 0.963
* Acc@1 95.349 loss -0.072 auroc 0.969 f1_score 0.950
------------------------------
* Acc@1 96.296 loss 0.534 auroc 1.000 f1_score 0.963
* Acc@1 95.349 loss -0.072 auroc 0.968 f1_score 0.950
------------------------------
* Acc@1 96.296 loss 0.533 auroc 1.000 f1_score 0.963
* Acc@1 95.349 loss -0.073 auroc 0.968 f1_score 0.950
------------------------------
* Acc@1 96.296 loss 0.533 auroc 1.000 f1_score 0.963
* Acc@1 95.349 loss -0.074 auroc 0.968 f1_score 0.950
------------------------------
* Acc@1 96.296 loss 0.533 auroc 1.000 f1_score 0.963
* Acc@1 95.349 loss -0.074 auroc 0.968 f1_score 0.950
------------------------------
* Acc@1 96.296 loss 0.533 auroc 1.000 f1_score 0.963
* Acc@1 95.349 loss -0.074 auroc 0.968 f1_score 0.950
------------------------------
* Acc@1 96.296 loss 0.533 auroc 1.000 f1_score 0.963
* Acc@1 95.349 loss -0.074 auroc 0.968 f1_score 0.950
------------------------------
Results on best epoch:
{'epoch': 6, 'val_acc': 96.29629629629629, 'val_auc': 1.0, 'val_f1': 0.9629629254341125, 'test_acc': 93.7984496124031, 'test_auc': 0.9563775658607483, 'test_f1': 0.9336420297622681}
